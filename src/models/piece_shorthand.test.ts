import { boardToShorthand, u, e, m } from "./piece_shorthand"

describe('board to shorthand', () => {
    test('starting position', () => {
        const shorthand = boardToShorthand(
            [
                [u('âš«ðŸ°'), u('âš«ðŸ´'), u('âš«â›ª'), u('âš«ðŸ‘¸'), u('âš«ðŸ¤´'), u('âš«â›ª'), u('âš«ðŸ´'), u('âš«ðŸ°')],
                [u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ')],
                [e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³')],
                [e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³')],
                [e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³')],
                [e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³')],
                [u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ')],
                [u('âšªðŸ°'), u('âšªðŸ´'), u('âšªâ›ª'), u('âšªðŸ‘¸'), u('âšªðŸ¤´'), u('âšªâ›ª'), u('âšªðŸ´'), u('âšªðŸ°')],
            ]
        )
        const expected = `
        [
            [u('âš«ðŸ°'), u('âš«ðŸ´'), u('âš«â›ª'), u('âš«ðŸ‘¸'), u('âš«ðŸ¤´'), u('âš«â›ª'), u('âš«ðŸ´'), u('âš«ðŸ°')],
            [u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ')],
            [e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³')],
            [e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³')],
            [e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³')],
            [e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³')],
            [u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ')],
            [u('âšªðŸ°'), u('âšªðŸ´'), u('âšªâ›ª'), u('âšªðŸ‘¸'), u('âšªðŸ¤´'), u('âšªâ›ª'), u('âšªðŸ´'), u('âšªðŸ°')]
        ]
        `
        expect(normalizeSpacing(shorthand)).toBe(normalizeSpacing(expected))
    })

    test('after queen side castle', () => {
        const shorthand = boardToShorthand(
            [
                [u('âš«ðŸ°'), u('âš«ðŸ´'), u('âš«â›ª'), u('âš«ðŸ‘¸'), u('âš«ðŸ¤´'), u('âš«â›ª'), u('âš«ðŸ´'), u('âš«ðŸ°')],
                [u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), u('âš«â™Ÿ')],
                [e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³')],
                [e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), m('âš«â™Ÿ'), m('âš«â™Ÿ'), m('âš«â™Ÿ'), m('âš«â™Ÿ'), e('ðŸ•³ ðŸ•³')],
                [e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), m('âšªâ™Ÿ'), e('ðŸ•³ ðŸ•³'), m('âšªâ›ª'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³')],
                [e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), m('âšªðŸ´'), m('âšªðŸ‘¸'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³')],
                [u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), e('ðŸ•³ ðŸ•³'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ')],
                [e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), m('âšªðŸ¤´'), m('âšªðŸ°'), e('ðŸ•³ ðŸ•³'), u('âšªâ›ª'), u('âšªðŸ´'), u('âšªðŸ°')],
            ]
        )
        const expected = `
        [
            [u('âš«ðŸ°'), u('âš«ðŸ´'), u('âš«â›ª'), u('âš«ðŸ‘¸'), u('âš«ðŸ¤´'), u('âš«â›ª'), u('âš«ðŸ´'), u('âš«ðŸ°')],
            [u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), u('âš«â™Ÿ')],
            [e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³')],
            [e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), m('âš«â™Ÿ'), m('âš«â™Ÿ'), m('âš«â™Ÿ'), m('âš«â™Ÿ'), e('ðŸ•³ ðŸ•³')],
            [e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), m('âšªâ™Ÿ'), e('ðŸ•³ ðŸ•³'), m('âšªâ›ª'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³')],
            [e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), m('âšªðŸ´'), m('âšªðŸ‘¸'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³')],
            [u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), e('ðŸ•³ ðŸ•³'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ')],
            [e('ðŸ•³ ðŸ•³'), e('ðŸ•³ ðŸ•³'), m('âšªðŸ¤´'), m('âšªðŸ°'), e('ðŸ•³ ðŸ•³'), u('âšªâ›ª'), u('âšªðŸ´'), u('âšªðŸ°')]
        ]
        `
        expect(normalizeSpacing(shorthand)).toBe(normalizeSpacing(expected))
    })
})

const normalizeSpacing = (s: string) => s.trim().split('\n').map(line => line.trim()).join('\n')