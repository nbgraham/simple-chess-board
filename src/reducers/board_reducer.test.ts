import { boardReducer } from './board_reducer';
import { u, e, m } from '../models/piece_shorthand';
import { IllegalMoveError } from '../utils/assert';
import { whitePawnJustReachedEndOfBoardAtRow0Col6 } from '../models/arrangements';
import { startingBoard, Board } from '../models/board';

test('first move works', () => {
    const boardAtStart = startingBoard;
    const boardAfterMove = boardReducer(boardAtStart, {
        type: 'move',
        piece: u('âšªâ™Ÿ'),
        moveFrom: { rowIndex: 6, columnIndex: 0 },
        moveTo: { rowIndex: 5, columnIndex: 0 },
    })

    expect(boardAfterMove.pieces).toEqual(
        [
            [u('âš«ğŸ°'), u('âš«ğŸ´'), u('âš«â›ª'), u('âš«ğŸ‘¸'), u('âš«ğŸ¤´'), u('âš«â›ª'), u('âš«ğŸ´'), u('âš«ğŸ°')],
            [u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [m('âšªâ™Ÿ'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ')],
            [u('âšªğŸ°'), u('âšªğŸ´'), u('âšªâ›ª'), u('âšªğŸ‘¸'), u('âšªğŸ¤´'), u('âšªâ›ª'), u('âšªğŸ´'), u('âšªğŸ°')],
        ]
    )
    expect(boardAfterMove.whiteScore).toBe(0);
    expect(boardAfterMove.piecesCapturedByWhite).toEqual([])
    expect(boardAfterMove.blackScore).toBe(0);
    expect(boardAfterMove.piecesCapturedByBlack).toEqual([])
});

test('capture', () => {
    const boardBeforeCapture = new Board(
        [
            [u('âš«ğŸ°'), u('âš«ğŸ´'), u('âš«â›ª'), u('âš«ğŸ‘¸'), u('âš«ğŸ¤´'), u('âš«â›ª'), u('âš«ğŸ´'), u('âš«ğŸ°')],
            [u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âš«â™Ÿ')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âšªâ™Ÿ'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [m('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), e('ğŸ•³ ğŸ•³'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ')],
            [u('âšªğŸ°'), u('âšªğŸ´'), u('âšªâ›ª'), u('âšªğŸ‘¸'), u('âšªğŸ¤´'), u('âšªâ›ª'), u('âšªğŸ´'), u('âšªğŸ°')],
        ],
        'white'
    )
    const boardAfterMove = boardReducer(boardBeforeCapture, {
        type: 'capture',
        piece: u('âšªâ›ª'),
        moveFrom: { rowIndex: 7, columnIndex: 2 },
        moveTo: { rowIndex: 2, columnIndex: 7 },
        capturingPiece: m('âš«â™Ÿ')
    })

    expect(boardAfterMove.pieces).toEqual(
        [
            [u('âš«ğŸ°'), u('âš«ğŸ´'), u('âš«â›ª'), u('âš«ğŸ‘¸'), u('âš«ğŸ¤´'), u('âš«â›ª'), u('âš«ğŸ´'), u('âš«ğŸ°')],
            [u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âšªâ›ª')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âšªâ™Ÿ'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [m('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), e('ğŸ•³ ğŸ•³'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ')],
            [u('âšªğŸ°'), u('âšªğŸ´'), e('ğŸ•³ ğŸ•³'), u('âšªğŸ‘¸'), u('âšªğŸ¤´'), u('âšªâ›ª'), u('âšªğŸ´'), u('âšªğŸ°')],
        ]
    )
    expect(boardAfterMove.whiteScore).toBe(1);
    expect(boardAfterMove.piecesCapturedByWhite).toEqual([m('âš«â™Ÿ')])
    expect(boardAfterMove.blackScore).toBe(0);
    expect(boardAfterMove.piecesCapturedByBlack).toEqual([])
});

describe('castling', () => {

    test('castle king side', () => {
        const initialBoard = new Board(
            [
                [u('âš«ğŸ°'), u('âš«ğŸ´'), u('âš«â›ª'), u('âš«ğŸ‘¸'), u('âš«ğŸ¤´'), u('âš«â›ª'), u('âš«ğŸ´'), u('âš«ğŸ°')],
                [u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), u('âš«â™Ÿ'), u('âš«â™Ÿ')],
                [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
                [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âš«â™Ÿ'), m('âš«â™Ÿ'), m('âš«â™Ÿ'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
                [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âšªâ›ª'), e('ğŸ•³ ğŸ•³'), m('âšªâ™Ÿ'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
                [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), u('âšªğŸ´'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
                [u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), e('ğŸ•³ ğŸ•³'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ')],
                [u('âšªğŸ°'), u('âšªğŸ´'), u('âšªâ›ª'), u('âšªğŸ‘¸'), u('âšªğŸ¤´'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), u('âšªğŸ°')],
            ],
            'white'
        )

        const boardAfterCastle = boardReducer(initialBoard, {
            type: 'castle',
            piece: u('âšªğŸ¤´'),
            moveFrom: { rowIndex: 7, columnIndex: 4 },
            moveTo: { rowIndex: 7, columnIndex: 7 }
        })


        expect(Board.getAllPieceLocations(initialBoard, 'white')).toHaveLength(16)
        expect(Board.getAllPieceLocations(initialBoard, 'black')).toHaveLength(16)
        expect(Board.getAllPieceLocations(boardAfterCastle, 'white')).toHaveLength(16)
        expect(Board.getAllPieceLocations(boardAfterCastle, 'black')).toHaveLength(16)

        expect(boardAfterCastle.pieces).toEqual(
            [
                [u('âš«ğŸ°'), u('âš«ğŸ´'), u('âš«â›ª'), u('âš«ğŸ‘¸'), u('âš«ğŸ¤´'), u('âš«â›ª'), u('âš«ğŸ´'), u('âš«ğŸ°')],
                [u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), u('âš«â™Ÿ'), u('âš«â™Ÿ')],
                [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
                [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âš«â™Ÿ'), m('âš«â™Ÿ'), m('âš«â™Ÿ'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
                [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âšªâ›ª'), e('ğŸ•³ ğŸ•³'), m('âšªâ™Ÿ'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
                [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), u('âšªğŸ´'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
                [u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), e('ğŸ•³ ğŸ•³'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ')],
                [u('âšªğŸ°'), u('âšªğŸ´'), u('âšªâ›ª'), u('âšªğŸ‘¸'), e('ğŸ•³ ğŸ•³'), m('âšªğŸ°'), m('âšªğŸ¤´'), e('ğŸ•³ ğŸ•³')],
            ]
        )
    })


    test('castle queen side', () => {
        const initialBoard = new Board(
            [
                [u('âš«ğŸ°'), u('âš«ğŸ´'), u('âš«â›ª'), u('âš«ğŸ‘¸'), u('âš«ğŸ¤´'), u('âš«â›ª'), u('âš«ğŸ´'), u('âš«ğŸ°')],
                [u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), u('âš«â™Ÿ')],
                [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
                [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âš«â™Ÿ'), m('âš«â™Ÿ'), m('âš«â™Ÿ'), m('âš«â™Ÿ'), e('ğŸ•³ ğŸ•³')],
                [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âšªâ™Ÿ'), e('ğŸ•³ ğŸ•³'), m('âšªâ›ª'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
                [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âšªğŸ´'), m('âšªğŸ‘¸'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
                [u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), e('ğŸ•³ ğŸ•³'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ')],
                [u('âšªğŸ°'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), u('âšªğŸ¤´'), u('âšªâ›ª'), u('âšªğŸ´'), u('âšªğŸ°')],
            ],
            'white'
        )

        const boardAfterCastle = boardReducer(initialBoard, {
            type: 'castle',
            piece: u('âšªğŸ¤´'),
            moveFrom: { rowIndex: 7, columnIndex: 4 },
            moveTo: { rowIndex: 7, columnIndex: 0 }
        })

        expect(Board.getAllPieceLocations(initialBoard, 'white')).toHaveLength(16)
        expect(Board.getAllPieceLocations(initialBoard, 'black')).toHaveLength(16)
        expect(Board.getAllPieceLocations(boardAfterCastle, 'white')).toHaveLength(16)
        expect(Board.getAllPieceLocations(boardAfterCastle, 'black')).toHaveLength(16)

        expect(boardAfterCastle.pieces).toEqual(
            [
                [u('âš«ğŸ°'), u('âš«ğŸ´'), u('âš«â›ª'), u('âš«ğŸ‘¸'), u('âš«ğŸ¤´'), u('âš«â›ª'), u('âš«ğŸ´'), u('âš«ğŸ°')],
                [u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), u('âš«â™Ÿ')],
                [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
                [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âš«â™Ÿ'), m('âš«â™Ÿ'), m('âš«â™Ÿ'), m('âš«â™Ÿ'), e('ğŸ•³ ğŸ•³')],
                [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âšªâ™Ÿ'), e('ğŸ•³ ğŸ•³'), m('âšªâ›ª'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
                [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âšªğŸ´'), m('âšªğŸ‘¸'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
                [u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), e('ğŸ•³ ğŸ•³'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ')],
                [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âšªğŸ¤´'), m('âšªğŸ°'), e('ğŸ•³ ğŸ•³'), u('âšªâ›ª'), u('âšªğŸ´'), u('âšªğŸ°')],
            ],
        )
    })
})

test('promote pawn', () => {
    const boardBeforeCapture = new Board(whitePawnJustReachedEndOfBoardAtRow0Col6, 'black')

    const boardAfterMove = boardReducer(boardBeforeCapture, {
        type: 'promote_pawn',
        piece: u('âšªâ™Ÿ'),
        location: { rowIndex: 0, columnIndex: 6 },
        promotedTo: 'queen'
    })

    expect(boardAfterMove.pieces).toEqual(
        [
            [u('âš«ğŸ°'), u('âš«ğŸ´'), u('âš«â›ª'), u('âš«ğŸ‘¸'), u('âš«ğŸ¤´'), u('âš«â›ª'), m('âšªğŸ‘¸'), u('âš«ğŸ°')],
            [u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), u('âš«â™Ÿ'), e('ğŸ•³ ğŸ•³'), u('âš«â™Ÿ'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âš«â™Ÿ'), m('âš«ğŸ´'), e('ğŸ•³ ğŸ•³'), m('âš«â™Ÿ')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âš«â™Ÿ'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), u('âšªâ™Ÿ'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), u('âšªâ™Ÿ')],
            [u('âšªğŸ°'), u('âšªğŸ´'), u('âšªâ›ª'), u('âšªğŸ‘¸'), u('âšªğŸ¤´'), u('âšªâ›ª'), u('âšªğŸ´'), u('âšªğŸ°')]
        ]
    )
});

test('queen move puts opponent in check', () => {
    const boardBeforeMove = new Board([
        [e('ğŸ•³ ğŸ•³'), m('âš«ğŸ¤´'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
        [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
        [e('ğŸ•³ ğŸ•³'), m('âš«â™Ÿ'), e('ğŸ•³ ğŸ•³'), m('âšªğŸ¤´'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
        [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
        [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
        [e('ğŸ•³ ğŸ•³'), m('âš«ğŸ‘¸'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âš«ğŸ°'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
        [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
        [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âš«ğŸ´'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âšªâ›ª'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')]
    ], 'black')

    const boardAfterMove = boardReducer(boardBeforeMove, {
        type: 'move',
        piece: m('âš«ğŸ‘¸'),
        moveFrom: { rowIndex: 5, columnIndex: 1 },
        moveTo: { rowIndex: 2, columnIndex: 4 },
    })

    expect(boardAfterMove.pieces).toEqual(
        [
            [e('ğŸ•³ ğŸ•³'), m('âš«ğŸ¤´'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), m('âš«â™Ÿ'), e('ğŸ•³ ğŸ•³'), m('âšªğŸ¤´'), m('âš«ğŸ‘¸'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âš«ğŸ°'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âš«ğŸ´'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âšªâ›ª'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')]
        ]
    )

})



test('knight move puts opponent in check', () => {
    const boardBeforeMove = new Board([
        [e('ğŸ•³ ğŸ•³'), m('âš«ğŸ¤´'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
        [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âšªğŸ¤´'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
        [e('ğŸ•³ ğŸ•³'), m('âš«â™Ÿ'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âš«ğŸ°'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
        [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
        [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
        [e('ğŸ•³ ğŸ•³'), m('âš«ğŸ‘¸'), e('ğŸ•³ ğŸ•³'), m('âš«ğŸ´'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âšªâ›ª')],
        [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
        [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')]
    ], 'black')

    const boardAfterMove = boardReducer(boardBeforeMove, {
        type: 'move',
        piece: m('âš«ğŸ´'),
        moveFrom: { rowIndex: 5, columnIndex: 3 },
        moveTo: { rowIndex: 3, columnIndex: 2 },
    })

    expect(boardAfterMove.pieces).toEqual(
        [
            [e('ğŸ•³ ğŸ•³'), m('âš«ğŸ¤´'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âšªğŸ¤´'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), m('âš«â™Ÿ'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âš«ğŸ°'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âš«ğŸ´'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), m('âš«ğŸ‘¸'), e('ğŸ•³ ğŸ•³'),  e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), m('âšªâ›ª')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')],
            [e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³'), e('ğŸ•³ ğŸ•³')]
        ]
    )

})